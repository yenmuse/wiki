
<!-- saved from url=(0127)file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html -->
<html lang="en" class="simpread-font simpread-theme-root" style="font-size: 56%!important;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
                        
                        
                        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
                        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=1">
                        <meta name="author" content="Kenshin">
                        <meta name="description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展">
                        <meta name="keywords" content="Chrome extension, Chrome 扩展, 阅读模式, 沉浸式阅读, 简悦, 简阅, read mode, reading mode, reader view, firefox, firefox addon, userscript, safari, opera, tampermonkey">
                        <meta name="thumbnail" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png">
                        <meta property="og:title" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展">
                        <meta property="og:type" content="website">
                        <meta property="og:local" content="zh_CN">
                        <meta property="og:url" content="http://ksria.com/simpread">
                        <meta property="og:image" content="https://simpread-1254315611.cos.ap-shanghai.myqcloud.com/static/introduce-2.png">
                        <meta property="og:image:type" content="image/png">
                        <meta property="og:image:width" content="960">
                        <meta property="og:image:height" content="355">
                        <meta property="og:site_name" content="http://ksria.com/simpread">
                        <meta property="og:description" content="简悦 SimpRead - 如杂志般沉浸式阅读体验的扩展">
                        <style type="text/css">.simpread-font{font:300 16px/1.8 -apple-system,PingFang SC,Microsoft Yahei,Lantinghei SC,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#333;text-rendering:optimizelegibility;-webkit-text-size-adjust:100%;-webkit-font-smoothing:antialiased}.simpread-hidden{display:none}.simpread-read-root{display:-webkit-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative;margin:0;top:-1000px;left:0;width:100%;z-index:2147483646;overflow-x:hidden;opacity:0;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}.simpread-read-root-show{top:0}.simpread-read-root-hide{top:1000px}sr-read{display:-webkit-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column;margin:20px 20%;min-width:400px;min-height:400px;text-align:center}read-process{position:fixed;top:0;left:0;height:3px;width:100%;background-color:#64b5f6;-webkit-transition:width 2s;transition:width 2s;z-index:20000}sr-rd-content-error{display:block;position:relative;margin:0;margin-bottom:30px;padding:25px;background-color:rgba(0,0,0,.05)}sr-rd-footer{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;font-size:14px}sr-rd-footer,sr-rd-footer-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}sr-rd-footer-group{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-rd-footer-line{width:100%;border-top:1px solid #e0e0e0}sr-rd-footer-text{min-width:150px}sr-rd-footer-copywrite{margin:10px 0 0;color:inherit}sr-rd-footer-copywrite abbr{-webkit-font-feature-settings:normal;font-feature-settings:normal;font-variant:normal;text-decoration:none}sr-rd-footer-copywrite .second{margin:10px 0}sr-rd-footer-copywrite .third a:hover{border:none!important}sr-rd-footer-copywrite .third a:first-child{margin-right:50px}sr-rd-footer-copywrite .sr-icon{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:33px;height:33px;opacity:.8;-webkit-transition:opacity .5s ease;transition:opacity .5s ease;cursor:pointer}sr-rd-footer-copywrite .sr-icon:hover{opacity:1}sr-rd-footer-copywrite a,sr-rd-footer-copywrite a:link,sr-rd-footer-copywrite a:visited{margin:0;padding:0;color:inherit;background-color:transparent;font-size:inherit!important;line-height:normal;text-decoration:none;vertical-align:baseline;vertical-align:initial;border:none!important;box-sizing:border-box}sr-rd-footer-copywrite a:focus,sr-rd-footer-copywrite a:hover,sr-rd-footer a:active{color:inherit;text-decoration:none;border-bottom:1px dotted!important}.simpread-blocks{text-decoration:none!important}.simpread-blocks *{margin:0}.simpread-blocks a{padding:0;text-decoration:none!important}.simpread-blocks img{margin:0;padding:0;border:0;background:transparent;box-shadow:none}.simpread-focus-root{display:block;position:fixed;top:0;left:0;right:0;bottom:0;background-color:hsla(0,0%,92%,.9);z-index:2147483645;opacity:0;-webkit-transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms;transition:opacity 1s cubic-bezier(.23,1,.32,1) 0ms}.simpread-focus-highlight{position:relative;box-shadow:0 0 0 20px #fff;background-color:#fff;overflow:visible;z-index:2147483646}.sr-controlbar-bg sr-rd-crlbar,.sr-controlbar-bg sr-rd-crlbar fab{z-index:2147483647}sr-rd-crlbar.controlbar{position:fixed;right:0;bottom:0;width:100px;height:100%;opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}sr-rd-crlbar.controlbar:hover{opacity:1}sr-rd-crlbar fap *{box-sizing:border-box}@media (max-height:620px){fab{zoom:.8}}@media (max-height:783px){dialog-gp dialog-content{max-height:580px}dialog-gp dialog-footer{border-top:1px solid #e0e0e0}}.simpread-highlight-selector{outline:3px dashed #1976d2!important;cursor:pointer!important}.simpread-highlight-controlbar,.simpread-highlight-selector{background-color:#fafafa!important;opacity:.8!important;-webkit-transition:opacity .5s ease!important;transition:opacity .5s ease!important}.simpread-highlight-controlbar{position:relative!important;border:3px dashed #1976d2!important}simpread-highlight,sr-snapshot-ctlbar{position:fixed;top:0;left:0;right:0;padding:15px;height:50px;background-color:rgba(50,50,50,.9);box-shadow:0 2px 5px rgba(0,0,0,.26);box-sizing:border-box;z-index:2147483640}simpread-highlight,sr-highlight-ctl,sr-snapshot-ctlbar{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sr-highlight-ctl{margin:0 5px;width:50px;height:20px;color:#fff;background-color:#1976d2;border-radius:4px;box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer}toc-bg{position:fixed;left:0;top:0;width:50px;height:200px;font-size:medium}toc-bg:hover{z-index:3}.toc-bg-hidden{opacity:0;-webkit-transition:opacity .5s ease;transition:opacity .5s ease}.toc-bg-hidden:hover{opacity:1;z-index:3}.toc-bg-hidden:hover toc{width:180px}toc *{all:unset}toc{position:fixed;left:0;top:100px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:10px;width:0;max-width:200px;max-height:500px;overflow-x:hidden;overflow-y:hidden;cursor:pointer;border:1px solid hsla(0,0%,62%,.22);-webkit-transition:width .5s;transition:width .5s}toc:hover{overflow-y:auto}toc.mini:hover{width:200px!important}toc::-webkit-scrollbar{width:3px}toc::-webkit-scrollbar-thumb{border-radius:10px;background-color:hsla(36,2%,54%,.5)}toc outline{position:relative;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;padding:2px 0;min-height:21px;line-height:21px;text-align:left}toc outline a,toc outline a:active,toc outline a:focus,toc outline a:visited{display:block;width:100%;color:inherit;font-size:11px;text-decoration:none!important;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}toc outline a:hover{font-weight:700!important}toc outline a.toc-outline-theme-dark,toc outline a.toc-outline-theme-night{color:#fff!important}.toc-level-h1{padding-left:5px}.toc-level-h2{padding-left:15px}.toc-level-h3{padding-left:25px}.toc-level-h4{padding-left:35px}.toc-outline-active{border-left:2px solid #f44336}toc outline active{position:absolute;left:0;top:0;bottom:0;padding:0 0 0 3px;border-left:2px solid #e8e8e8}sr-kbd{background:-webkit-gradient(linear,0 0,0 100%,from(#fff785),to(#ffc542));border:1px solid #e3be23;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;position:absolute;left:0;padding:1px 3px 0;font-size:11px!important;font-weight:700;box-shadow:0 3px 7px 0 rgba(0,0,0,.3);overflow:hidden;border-radius:3px}.sr-kbd-a{position:relative}kbd-mapping{position:fixed;left:5px;bottom:5px;-ms-flex-flow:row;flex-flow:row;width:250px;height:500px;background-color:#fff;border:1px solid hsla(0,0%,62%,.22);box-shadow:0 2px 5px rgba(0,0,0,.26);border-radius:3px}kbd-mapping,kbd-maps{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}kbd-maps{margin:40px 0 20px;width:100%;overflow-x:auto}kbd-maps::-webkit-scrollbar-thumb{background-clip:padding-box;border-radius:10px;border:2px solid transparent;background-color:rgba(85,85,85,.55)}kbd-maps::-webkit-scrollbar{width:10px;-webkit-transition:width .7s cubic-bezier(.4,0,.2,1);transition:width .7s cubic-bezier(.4,0,.2,1)}kbd-mapping kbd-map-title{position:absolute;margin:5px 0;width:100%;font-size:14px;font-weight:700}kbd-maps-group{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}kbd-maps-title{margin:5px 0;padding-left:53px;font-size:12px;font-weight:700}kbd-map kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #c6cbd1;border-bottom-color:#959da5;border-radius:3px;box-shadow:inset 0 -1px 0 #959da5}kbd-map kbd-name{display:inline-block;text-align:right;width:50px}kbd-map kbd-desc{padding-left:3px}sharecard-bg{position:fixed;top:0;left:0;width:100%;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0,0,0,.4);z-index:2147483647}sharecard{max-width:450px;background-color:#64b5f6}sharecard,sharecard-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-head{margin:25px;color:#fff;border-radius:10px;box-shadow:0 2px 6px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.15)}sharecard-card{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sharecard-card,sharecard-top{display:-webkit-box;display:-ms-flexbox;display:flex}sharecard-top{-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:65px;background-color:#fff;color:#878787;font-size:25px;font-weight:500;border-top-left-radius:10px;border-top-right-radius:10px}sharecard-top span.logos{display:block;width:48px;height:48px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABU1BMVEUAAAAnNJMnNZI3Q5onNJInNJMnNJInNJMnNJI8SJ0tOZY/S55EUKAoNJI6RpwoNJNIU6InNJInNJImNJI7SJwmNJJ2fLUiMJFKVaNCTJ9faK1HUaJOWKVSXaUnNJNYY6pye7cmM5JXYKhwebMjMI8mL4719fW9vb0oNZP/UlLz8/QqN5TAwMAnNJPv7+/Pz8/q6+/p6enNzc3Kysry8vMsOJXc3env7/LU1uXo29vR0dHOzs7ExMTwjo73bW37XV3Aj1TCYELl5u3n5+fW2Obn6O7f4OrZ2+g0QJkxPpgvO5bh4uvS1OTP0ePCwsJQW6ZLVqTs7fHd3d3V1dXqv79VX6lET6A1TIxXUIBSgHxWQnpelHf+WVnopkXqbC7j5Ozi4uLDw8NGUaFATJ9SgH3r6+vGyd7BxNva2trX19ejqM2gpczHx8dze7Zha67Z2dlTgH1aXQeSAAAAJnRSTlMA6ff+497Y8NL+/fv49P379sqab/BeOiX06tzVy8m/tKqpalA7G6oKj0EAAAJlSURBVEjHndNXWxpBFIDhcS2ICRLAkt4Dx4WhLk0E6R0MYoIISrWX5P9f5cwSIRC2+T1czMV5n2FnZwn2eWONUqCAv3H2Uf5Ra1hx4+0WEXtDQW0fCPYJ1EffEfIV4CSROAE4jsePoTFsNmTJF/IeIHF2lgCIn57GodlqDWXBK7IwBYatVlMWFAildPKX7I3m74Z9fsCiQChoimoFQAz04Ad2gH1n9fv9n9hgMNDr9euLWD6fLxQKxaLfb7dTSlahbFVdEPwIQtrAihZQgyKCtCagbQe3xh0QFMgy5MR11+ewYY5/qlZ7vT2xu93ULKjbFLpiUxnIIwjgKmVTLDUFXMrAi2NJWCRLIthTBo4xyOLKpwyqU6CuDCI41hFBCVdOhyLw4FgJ1skCAiyl9BSHbCorgo6VJXTru5hrVCQS8Yr5xLzX59YJSFpVFwD9U0BGC3hGdFpATgRupTGe9R9I1b1ePBvXKDyvq/O/44LT4/E4BUbSCAwj8Evq6HlnOBprx6JhJz8Gktc7xeaP9ndY+0coQvCccFBD4JW60UIY50ciLOAODAQRVOeCHm4Q3Xks6uRDY+CQ+AR4T2wMYh6+jMCIQOp78CFoj0H7EQgIuhI3dGaHCrwgADwCPjJvA372GRigCJg49FUdk3D87pq3zp4SA5zc1Zh9DxfwkpjgUg5Mv+lbeE3McC8Lpu7SA3wk2xzcqL2tN5DfIsQC8HB7UamUy6FQOpTO5QKBQDZbKnWSyUzGjdWCwaDA8+7Le4BNgm3qQGWchYh9s5hNq6wVbBlbwhZYOp3OYOA4zmgEypnM2zj8ByIdedKrH8vDAAAAAElFTkSuQmCC");zoom:.8}sharecard-content{padding:15px;max-height:500px;font-size:20px;text-align:justify;background-color:#2196f3;overflow-x:hidden;overflow-y:auto}sharecard-via{padding:10px;font-size:10px;background-color:#2196f3}sharecard-footer{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding-right:5px;height:100px;background-color:#fff;color:#878787;font-size:15px;font-weight:500;border-bottom-left-radius:10px;border-bottom-right-radius:10px}sharecard-footer,sharecard-footer div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}sharecard-footer span.qrcode{display:block;width:100px;height:100px;margin:5px;background-repeat:no-repeat;background-position:50%;background-image:url("data:image/png;base64,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")}sharecard-control{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 19px;height:80px;background-color:#fff}simpread-snapshot{width:100%;height:100%;cursor:move;z-index:2147483645}simpread-snapshot,sr-mask{position:fixed;left:0;top:0}sr-mask{background-color:rgba(0,0,0,.1)}.simpread-feedback,.simpread-urlscheme{position:fixed;right:20px;bottom:20px;z-index:2147483646}simpread-feedback,simpread-urlscheme{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:20px 20px 0;width:500px;color:rgba(51,51,51,.87);background-color:#fff;border-radius:3px;box-shadow:0 0 2px rgba(0,0,0,.12),0 2px 2px rgba(0,0,0,.26);overflow:hidden;-webkit-transform-origin:bottom;transform-origin:bottom;-webkit-transition:all .6s ease;transition:all .6s ease}simpread-feedback *,simpread-urlscheme *{font-size:12px!important;box-sizing:border-box}simpread-feedback.active,simpread-urlscheme.active{-webkit-animation-name:srFadeInUp;animation-name:srFadeInUp;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback.hide,simpread-urlscheme.hide{-webkit-animation-name:srFadeInDown;animation-name:srFadeInDown;-webkit-animation-duration:.45s;animation-duration:.45s;-webkit-animation-fill-mode:both;animation-fill-mode:both}simpread-feedback sr-fb-label,simpread-urlscheme sr-urls-label{width:100%}simpread-feedback sr-fb-head,simpread-urlscheme sr-urls-head{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-bottom:5px;width:100%}simpread-feedback sr-fb-content,simpread-urlscheme sr-urls-content{margin-bottom:5px;width:100%}simpread-feedback sr-urls-footer,simpread-urlscheme sr-urls-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-fb-a,simpread-urlscheme sr-urls-a{color:#2163f7;cursor:pointer}simpread-feedback text-field-state,simpread-urlscheme text-field-state{border-top:none rgba(34,101,247,.8)!important;border-left:none rgba(34,101,247,.8)!important;border-right:none rgba(34,101,247,.8)!important;border-bottom:2px solid rgba(34,101,247,.8)!important}simpread-feedback switch,simpread-urlscheme switch{margin-top:0!important}@-webkit-keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes srFadeInUp{0%{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}@keyframes srFadeInDown{0%{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}to{opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px)}}simpread-feedback sr-fb-head{font-weight:700}simpread-feedback sr-fb-content{-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column}simpread-feedback sr-fb-content,simpread-feedback sr-fb-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}simpread-feedback sr-fb-footer{-webkit-box-orient:horizontal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;width:100%}simpread-feedback sr-close{position:absolute;right:20px;cursor:pointer;-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s;z-index:200}simpread-feedback sr-close:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-top:10px}simpread-feedback sr-stars i{margin-right:10px;cursor:pointer}simpread-feedback sr-stars i svg{-webkit-transition:all 1s cubic-bezier(.23,1,.32,1) .1s;transition:all 1s cubic-bezier(.23,1,.32,1) .1s}simpread-feedback sr-stars i svg:hover{-webkit-transform:rotate(-15deg) scale(1.3);transform:rotate(-15deg) scale(1.3)}simpread-feedback sr-stars i.active svg{-webkit-transform:rotate(0) scale(1);transform:rotate(0) scale(1)}simpread-feedback sr-emojis{display:block;height:100px;overflow:hidden}simpread-feedback sr-emoji{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-transition:.3s;transition:.3s}simpread-feedback sr-emoji>svg{margin:15px 0;width:70px;height:70px;-ms-flex-negative:0;flex-shrink:0}simpread-feedback sr-stars-footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:10px 0 20px}</style>
                        <style type="text/css">.simpread-theme-root{font-size:62.5%!important}sr-rd-content,sr-rd-desc,sr-rd-title{width:100%}sr-rd-title{display:-webkit-box;margin:1em 0 .5em;overflow:hidden;text-overflow:ellipsis;text-rendering:optimizelegibility;-webkit-line-clamp:3;-webkit-box-orient:vertical}sr-rd-content{text-align:left;word-break:break-word}sr-rd-desc{text-align:justify;line-height:2.4;margin:0 0 1.2em;box-sizing:border-box}sr-rd-content{font-size:25.6px;font-size:1.6rem;line-height:1.6}sr-rd-content h1,sr-rd-content h1 *,sr-rd-content h2,sr-rd-content h2 *,sr-rd-content h3,sr-rd-content h3 *,sr-rd-content h4,sr-rd-content h4 *,sr-rd-content h5,sr-rd-content h5 *,sr-rd-content h6,sr-rd-content h6 *{word-break:break-all}sr-rd-content div,sr-rd-content p{display:block;float:inherit;line-height:1.6;font-size:25.6px;font-size:1.6rem}sr-rd-content div,sr-rd-content p,sr-rd-content pre,sr-rd-content sr-blockquote{margin:0 0 1.2em;word-break:break-word}sr-rd-content a{padding:0 5px;vertical-align:baseline;vertical-align:initial}sr-rd-content a,sr-rd-content a:link{color:inherit;font-size:inherit;font-weight:inherit;border:none}sr-rd-content a:hover{background:transparent}sr-rd-content img{margin:10px;padding:5px;max-width:100%;background:#fff;border:1px solid #bbb;box-shadow:1px 1px 3px #d4d4d4}sr-rd-content figcaption{text-align:center;font-size:14px}sr-rd-content sr-blockquote{display:block;position:relative;padding:15px 25px;text-align:left;line-height:inherit}sr-rd-content sr-blockquote:before{position:absolute}sr-rd-content sr-blockquote *{margin:0;font-size:inherit}sr-rd-content table{width:100%;margin:0 0 1.2em;word-break:keep-all;word-break:normal;overflow:auto;border:none}sr-rd-content table td,sr-rd-content table th{border:none}sr-rd-content ul{margin:0 0 1.2em;margin-left:1.3em;padding:0;list-style:disc}sr-rd-content ol{list-style:decimal;margin:0;padding:0}sr-rd-content ol li,sr-rd-content ul li{font-size:inherit;list-style:disc;margin:0 0 1.2em}sr-rd-content ol li{list-style:decimal;margin-left:1.3em}sr-rd-content ol li *,sr-rd-content ul li *{margin:0;text-align:left;text-align:initial}sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em}sr-rd-content li ul{list-style:circle}sr-rd-content pre{font-family:Consolas,Monaco,Andale Mono,Source Code Pro,Liberation Mono,Courier,monospace;display:block;padding:15px;line-height:1.5;word-break:break-all;word-wrap:break-word;white-space:pre;overflow:auto}sr-rd-content pre,sr-rd-content pre *,sr-rd-content pre div{font-size:17.6px;font-size:1.1rem}sr-rd-content li pre code,sr-rd-content p pre code,sr-rd-content pre{background-color:transparent;border:none}sr-rd-content pre code{margin:0;padding:0}sr-rd-content pre code,sr-rd-content pre code *{font-size:17.6px;font-size:1.1rem}sr-rd-content pre p{margin:0;padding:0;color:inherit;font-size:inherit;line-height:inherit}sr-rd-content li code,sr-rd-content p code{margin:0 4px;padding:2px 4px;font-size:17.6px;font-size:1.1rem}sr-rd-content mark{margin:0 5px;padding:2px;background:#fffdd1;border-bottom:1px solid #ffedce}.sr-rd-content-img{width:90%;height:auto}.sr-rd-content-img-load{width:48px;height:48px;margin:0;padding:0;border-style:none;border-width:0;background-repeat:no-repeat;background-image:url(data:image/gif;base64,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)}.sr-rd-content-center{text-align:center;display:-webkit-box;-webkit-box-align:center;-webkit-box-pack:center;-webkit-box-orient:vertical}.sr-rd-content-center-small{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.sr-rd-content-center-small img{margin:0;padding:0;border:0;box-shadow:none}img.simpread-img-broken{cursor:pointer}.sr-rd-content-nobeautify{margin:0;padding:0;border:0;box-shadow:0 0 0}sr-rd-mult{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin:0 0 16px;padding:16px 0 24px;width:100%;background-color:#fff;border-radius:4px;box-shadow:0 1px 2px 0 rgba(60,64,67,.3),0 2px 6px 2px rgba(60,64,67,.15)}sr-rd-mult:hover{-webkit-transition:all .45s 0ms;transition:all .45s 0ms;box-shadow:1px 1px 8px rgba(0,0,0,.16)}sr-rd-mult sr-rd-mult-content{padding:0 16px;overflow:auto}sr-rd-mult sr-rd-mult-avatar,sr-rd-mult sr-rd-mult-content{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}sr-rd-mult sr-rd-mult-avatar{-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0 15px}sr-rd-mult sr-rd-mult-avatar span{display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;max-width:75px;overflow:hidden;text-overflow:ellipsis;text-align:left;font-size:16px;font-size:1rem}sr-rd-mult sr-rd-mult-avatar img{margin-bottom:0;max-width:50px;max-height:50px;width:50px;height:50px;border-radius:50%}sr-rd-mult sr-rd-mult-content img{max-width:80%}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center{margin:0}sr-page{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;width:100%}</style>
                        <style type="text/css">sr-rd-theme-engwrite{display:none}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin:20px 0 10px;padding:0;font-weight:500;-webkit-font-smoothing:antialiased}sr-rd-content h1{font-weight:300;text-align:center;font-size:44.8px;font-size:2.8rem;color:#933d3f}sr-rd-content h2{font-size:38.4px;font-size:2.4rem;border-bottom:1px solid #ccc;color:#000}sr-rd-content h3{font-size:28.8px;font-size:1.8rem}sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:25.6px;font-size:1.6rem}sr-rd-content h6{color:#777}sr-rd-content ol,sr-rd-content ul{padding-left:30px}sr-rd-content ol li>:first-child,sr-rd-content ol li ol:first-of-type,sr-rd-content ol li ul:first-of-type,sr-rd-content ul li>:first-child,sr-rd-content ul li ol:first-of-type,sr-rd-content ul li ul:first-of-type{margin-top:0}sr-rd-content ol ol,sr-rd-content ol ul,sr-rd-content ul ol,sr-rd-content ul ul{margin-bottom:0}sr-rd-content table th{font-weight:700}sr-rd-content table td,sr-rd-content table th{border:1px solid #ccc;padding:6px 13px}sr-rd-content table tr{border-top:1px solid #ccc;background-color:#fff}sr-rd-content table tr:nth-child(2n){background-color:#f8f8f8}sr-rd-content sr-blockquote{text-align:left;border-top:1px dotted #cdc7bc;border-bottom:1px dotted #cdc7bc;background-color:#f8edda;color:#777}sr-blockquote>:first-child{margin-top:0}sr-blockquote>:last-child{margin-bottom:0}.simpread-multi-root,.simpread-theme-root{background-color:#fcf5ed;color:#333}sr-rd-title{font-weight:300;text-align:center;font-size:44.8px;font-size:2.8rem;color:#933d3f}sr-rd-desc{padding:10px;background-color:#f8edda;color:#777;font-size:32px;font-size:2rem;text-align:center;border-top:1px dotted #cdc7bc;border-bottom:1px dotted #cdc7bc}sr-rd-content{padding:20px 0;margin:0 auto}sr-rd-content,sr-rd-content *,sr-rd-content div,sr-rd-content p{color:#333;line-height:1.8}sr-rd-content a,sr-rd-content a:link{color:#ae3737;text-decoration:none}sr-rd-content a:active,sr-rd-content a:focus,sr-rd-content a:hover{text-decoration:underline}sr-rd-content pre{background-color:transparent;border:1px solid #ccc;border-radius:3px}sr-rd-content li code,sr-rd-content p code{border:1px solid #eaeaea;background-color:#f4ece3;border-radius:3px}sr-rd-mult{background-color:#f8edda}</style>
                        <style type="text/css"></style>
                        <style type="text/css">@media (pointer:coarse){sr-read{margin:20px 5%!important;min-width:0!important;max-width:90%!important}sr-rd-title{margin-top:0;font-size:2.7rem}sr-rd-content sr-blockquote,sr-rd-desc{margin:10 0!important;padding:0 0 0 10px!important;width:90%;font-size:1.8rem;font-style:normal;line-height:1.7;text-align:justify}sr-rd-content{font-size:1.75rem;font-weight:300}sr-rd-content figure{margin:0;padding:0;text-align:center}sr-rd-content a,sr-rd-content a:link,sr-rd-content li code,sr-rd-content p code{font-size:inherit}sr-rd-footer{margin-top:20px}sr-blockquote,sr-blockquote *{margin:5px!important;padding:5px!important}sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6,sr-rd-title{font-family:PingFang SC,Verdana,Helvetica Neue,Microsoft Yahei,Hiragino Sans GB,Microsoft Sans Serif,WenQuanYi Micro Hei,sans-serif;color:#000;font-weight:100;line-height:1.35}sr-rd-content-h1,sr-rd-content-h2,sr-rd-content-h3,sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h1,sr-rd-content h2,sr-rd-content h3,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{margin-top:1.2em;margin-bottom:.6em;line-height:1.35}sr-rd-content-h1,sr-rd-content h1{font-size:1.8em}sr-rd-content-h2,sr-rd-content h2{font-size:1.6em}sr-rd-content-h3,sr-rd-content h3{font-size:1.4em}sr-rd-content-h4,sr-rd-content-h5,sr-rd-content-h6,sr-rd-content h4,sr-rd-content h5,sr-rd-content h6{font-size:1.2em}sr-rd-content-ul,sr-rd-content ul{margin-left:1.3em!important;list-style:disc}sr-rd-content-ol,sr-rd-content ol{list-style:decimal;margin-left:1.9em!important}sr-rd-content-ol ol,sr-rd-content-ol ul,sr-rd-content-ul ol,sr-rd-content-ul ul,sr-rd-content li ol,sr-rd-content li ul{margin-bottom:.8em;margin-left:2em!important}sr-rd-content img{margin:0;padding:0;border:0;max-width:100%!important;height:auto;box-shadow:0 20px 20px -10px rgba(0,0,0,.1)}sr-rd-mult{min-width:0;background-color:#fff;box-shadow:0 1px 6px rgba(32,33,36,.28);border-radius:8px}sr-rd-mult sr-rd-mult-avatar div{margin:0}sr-rd-mult sr-rd-mult-avatar .sr-rd-content-center-small{margin:7px 0!important}sr-rd-mult sr-rd-mult-avatar span{display:block}sr-rd-mult sr-rd-mult-content{padding-left:0}@media only screen and (max-device-width:1024px){.simpread-theme-root,html.simpread-theme-root{font-size:80%!important}sr-rd-mult sr-rd-mult-avatar img{width:50px;height:50px;min-width:50px;min-height:50px}toc-bg toc{width:10px!important}toc-bg:hover toc{width:auto!important}}@media only screen and (max-device-width:414px){.simpread-theme-root,html.simpread-theme-root{font-size:70%!important}sr-rd-mult sr-rd-mult-avatar img{width:30px;height:30px;min-width:30px;min-height:30px}}@media only screen and (max-device-width:320px){.simpread-theme-root,html.simpread-theme-root{font-size:90%!important}sr-rd-content p{margin-bottom:.5em}}}</style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {}sr-rd-content pre code, sr-rd-content pre code * {}sr-rd-desc {}sr-rd-content pre {}sr-rd-title {}</style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css"></style>
                        <style type="text/css">sr-rd-content *, sr-rd-content p, sr-rd-content div {
        font-size: 15px;
    }

    .annote-perview, .annote-perview * {
        color: rgb(85, 85, 85);
        font-weight: 400;
        line-height: 1.8;
    }</style>
                        
                        
                        <script>setTimeout(()=>{const e=location.hash.replace("#id=","");let t,a=!1;const n=t=>{for(let n of t){let t;if((t=e.length>6?n.getAttribute("data-id"):n.getAttribute("data-idx"))==e){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),a=!0;break}}};e&&(0==(t=document.getElementsByClassName("sr-unread-card")).length&&(t=document.getElementsByTagName("sr-annote")),n(t),a||n(t=document.getElementsByClassName("sr-annote")))},500);</script>
                        
                        <title>简悦 | Functional Programming For The Rest of Us | defmacro</title>
                    </head>
                    <body>
                        <sr-read style="undefined">
                            <sr-rd-title>Functional Programming For The Rest of Us | defmacro</sr-rd-title>
                    <sr-rd-desc style="margin: 0;padding-top: 0;padding-bottom: 0;font-style: normal;font-size: 18px;">Introduction Programmers are procrastinators. Get in, get some coffee, check the mailbox, read the RS......</sr-rd-desc>
                    <sr-rd-content><p></p><div>
        <article itemscope="" itemtype="http://schema.org/BlogPosting">

  

  <div itemprop="articleBody">
    <h2 id="sr-toc-0"><a>Introduction</a></h2>
<p>Programmers are procrastinators. Get in, get some coffee, check the mailbox, read the RSS feeds,
read the news, check out latest articles on techie websites, browse through political discussions on the designated
sections of the programming forums. Rinse and repeat to make sure nothing is missed. Go to lunch. Come back, stare
at the IDE for a few minutes. Check the mailbox. Get some coffee. Before you know it, the day is over.</p>
<p>The only thing, every once in a while challenging articles actually do pop up. If you're looking at the right
places you'll find at least one of these every couple of days. These articles are hard to get through and take
some time, so they start piling up. Before you know it, you have a list of links and a folder full of PDF files
and you wish you had a year in a small hut in the middle of the forest with nobody around for miles so you could
catch up. Would be nice if someone came in every morning while you're taking a walk down the river to bring some
food and take out the garbage.</p>
<p>I don't know about your list, but a large chunk of the articles in mine are about functional programming. These
generally are the hardest to get through. Written in a dry academic language, even the "ten year Wall Street industry
veterans"don't understand what functional programming (also referred to as <em>FP</em>) articles are all about. If you ask a project
manager in Citi Group or in Deutsche Bank<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#ask-a-manager">1</a></sup> why they chose to use JMS instead
of Erlang they'll say they can't use academic languages for industrial strength applications. The problem is, some of
the most complex systems with the most rigid requirements are written using functional programming
elements. Something doesn't add up.</p>
<p>It's true that FP articles and papers are hard to understand, but they don't have to be. The reasons for the
knowledge gap are purely historical. There is nothing inherently hard about FP concepts. Consider this article "an
accessible guide to FP", a bridge from our imperative minds into the world of FP. Grab a coffee and keep on reading.
With any luck your coworkers will start making fun of you for your FP comments in no time.</p>
<p>So what is FP? How did it come about? Is it edible? If it's as useful
as its advocates claim, why isn't it being used more often in the industry? Why is it that only people with PhDs
tend to use it? Most importantly, why is it so damn hard to learn? What is all this closure, continuation, currying,
lazy evaluation and no side effects business? How can it be used in projects that don't involve a university?
Why does it seem to be so different from everything good, and holy, and dear to our imperative hearts? We'll clear
this up very soon. Let's start with explaining the reasons for the huge gap between the real world and academic
articles. The answer is as easy as taking a walk in the park.</p>
<h2 id="sr-toc-1"><a>A Walk In The Park</a></h2>
<p>Fire up the time machine. Our walk in the park took place more than two thousand years ago, on a
beautiful sunny day of a long forgotten spring in 380 B.C. Outside the city walls of Athens, under the pleasant shade
of olive trees Plato was walking towards the Academy with a beautiful slave boy. The weather was lovely, the dinner
was filling, and the conversation turned to philosophy.</p>
<p>"Look at these two students", said Plato carefully picking words to make the question educational. "Who do you
think is taller?"The slave boy looked towards the basin of water where two men were standing."They're about
the same height", he said."What do you mean 'about the same'?", asked Plato."Well, they look the same from here
but I'm sure if I were to get closer I'd see that there is some difference."</p>
<p>Plato smiled. He was leading the boy in the right direction. "So you would say that there is nothing perfectly
equal in our world?"After some thinking the boy replied:"I don't think so. Everything is at least a little
different, even if we can't see it." The point hit home! "Then if nothing is perfectly equal in this world, how
do you think you understand the concept of 'perfect' equality?"The slave boy looked puzzled."I don't know",
he replied.</p>
<p>So was born the first attempt to understand the nature of mathematics. Plato suggested that everything in
our world is just an approximation of perfection. He also realized that we understand the concept of perfection
even though we never encountered it. He came to conclusion that perfect mathematical forms must live in another
world and that we somehow know about them by having a connection to that "alternative" universe. It's fairly
clear that there is no perfect circle that we can observe. But we also understand what a perfect circle is and
can describe it via equations. What is mathematics, then? Why is the universe described with mathematical laws?
Can all of the phenomena of our universe be described by mathematics?<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#universe-math">2</a></sup></p>
<p><a href="http://en.wikipedia.org/wiki/Philosophy_of_mathematics">Philosophy of mathematics</a> is a very
complex subject. Like most philosophical disciplines it is far more adept at posing questions rather than providing
answers. Much of the consensus revolves around the fact that mathematics is really a puzzle: we set up a set of
basic non-conflicting principles and a set of rules on how to operate with these principles. We can then stack
these rules together to come up with more complex rules. Mathematicians call this method a "formal system" or a
"calculus". We can effectively write a formal system for Tetris if we wanted to. In fact, a working implementation of Tetris
<em>is</em> a formal system, just specified using an unusual representation.</p>
<p>A civilization of furry creatures on Alpha Centauri would not be able to read our formalisms of Tetris
and circles because their only sensory input might be an organ that senses smells. They likely will never find
out about the Tetris formalism, but they very well might have a formalism for circles. We probably wouldn't
be able to read it because our sense of smell isn't that sophisticated, but once you get past the
<em>representation</em> of the formalism (via various sensory instruments and standard code breaking
techniques to understand the <em>language</em>), the concepts underneath are understandable to any
intelligent civilization.</p>
<p>Interestingly if no intelligent civilization ever existed in the universe the formalisms for Tetris and circles
would still hold water, it's just that nobody would be around to find out about them. If an intelligent
civilization popped up, it would likely discover some formalisms that help describe the laws of our universe.
They also would be very unlikely to ever find out about Tetris because there is nothing in the universe
that resembles it. Tetris is one of countless examples of a formal system, a puzzle, that has nothing to do
with the real world. We can't even be sure that natural numbers have full resemblance to the real world,
after all one can easily think of a number so big that it cannot describe anything in our universe
since it might actually turn out to be finite.</p>
<h2 id="sr-toc-2"><a>A Bit of History</a><sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#history">3</a></sup></h2>
<p>Let's shift gears in our time machine. This time we'll travel a lot closer, to the 1930s.
The Great Depression was ravaging the New and the Old worlds. Almost every family from every social class
was affected by the tremendous economic downturn. Very few sanctuaries remained where people were safe
from the perils of poverty. Few people were fortunate enough to be in these sanctuaries, but they did exist. Our
interest lies in mathematicians in Princeton University.</p>
<p>The new offices constructed in gothic style gave Princeton an aura of a safe haven. Logicians from all over
the world were invited to Princeton to build out a new department. While most of America couldn't find a piece of
bread for dinner, high ceilings, walls covered with elaborately carved wood, daily discussions by a cup of tea,
and walks in the forest were some of the conditions in Princeton.</p>
<p>One mathematician living in such lavish lifestyle was a young man named Alonzo Church. Alonzo received a B.S.
degree from Princeton and was persuaded to stay for graduate school. Alonzo felt the architecture was fancier than
necessary. He rarely showed up to discuss mathematics with a cup of tea and he didn't enjoy the walks in the woods.
Alonzo was a loner: he was most productive when working on his own. Nevertheless Alonzo had regular contacts with
other Princeton inhabitants. Among them were Alan Turing, John von Neumann, and Kurt Gödel.</p>
<p>The four men were interested in formal systems. They didn't pay much heed to the physical world, they were
interested in dealing with abstract mathematical puzzles instead. Their puzzles had something in common: the
men were working on answering questions about <em>computation.</em> If we had machines that had infinite computational
power, what problems would we be able to solve? Could we solve them automatically? Could some problems remain
unsolved and why? Would various machines with different designs be equal in power?</p>
<p>In cooperation with other men Alonzo Church developed a formal system called <em>lambda calculus.</em> The
system was essentially a programming language for one of these imaginary machines. It was based on functions
that took other functions as parameters and returned functions as results. The function was identified by a
Greek letter lambda, hence the system's name<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#lambda">4</a></sup>. Using this formalism
Alonzo was able to reason about many of the above questions and provide conclusive answers.</p>
<p>Independently of Alonzo Church, Alan Turing was performing similar work. He developed a different
formalism (now referred to as the Turing machine), and used it to independently come to similar conclusions as
Alonzo. Later it was shown that Turing machines and lambda calculus were equivalent in power.</p>
<p>This is where the story would stop, I'd wrap up the article, and you'd navigate to another page, if not
for the beginning of World War II. The world was in flames. The U.S. Army and Navy used artillery more often
than ever. In attempts to improve accuracy the Army employed a large group of mathematicians to continuously
calculate differential equations required for solving ballistic firing tables. It was becoming obvious that
the task was too great for being solved manually and various equipment was developed in order to overcome
this problem. The first machine to solve ballistic tables was a Mark I built by IBM - it weighed five tons,
had 750,000 parts and could do three operations per second.</p>
<p>The race, of course, wasn't over. In 1949 an Electronic Discrete Variable Automatic Computer (<em>EDVAC</em>)
was unveiled and had tremendous success. It was a first example of von Neumann's architecture and was effectively
a real world implementation of a Turing machine. For the time being Alonzo Church was out of luck.</p>
<p>In late 1950s an MIT professor John McCarthy (also a Princeton graduate) developed interest in Alonzo
Church's work. In 1958 he unveiled a List Processing language (Lisp). Lisp was an implementation of Alonzo's
lambda calculus that worked on von Neumann computers! Many computer scientists recognized the expressive
power of Lisp. In 1973 a group of programmers at MIT's Artificial Intelligence Lab developed hardware they
called a Lisp machine - effectively a native hardware implementation of Alonzo's lambda calculus!</p>
<h2 id="sr-toc-3"><a>Functional Programming</a></h2>
<p>Functional programming is a practical implementation of Alonzo Church's ideas. Not all lambda
calculus ideas transform to practice because lambda calculus was not designed to work under physical limitations.
Therefore, like object oriented	programming, functional programming is a set of ideas, not a set of strict guidelines.
There are many functional programming languages, and most of them do many things very differently. In this article I will explain
the most widely used ideas from functional languages using examples written in Java (yes, you could write
functional programs in Java if you felt particularly masochistic). In the next couple of sections we'll take
Java as is, and will make modifications to it to transform it into a useable functional language. Let's
begin our quest.</p>
<p>Lambda calculus was designed to investigate problems related to <em>calculation.</em> Functional programming,
therefore, primarily deals with calculation, and, surprisingly, uses functions to do so. A function is a very
basic unit in functional programming. Functions are used for almost everything, even the simplest of calculations.
Even variables are replaced with functions. In functional programming variables are simply aliases for expressions
(so we don't have to type everything on one line). They cannot be modified. All variables can only be assigned to
once. In Java terms this means that every single variable is declared as <em>final</em> (or <em>const</em> if we're
dealing with C++). There are no non-final variables in FP.</p>
<pre>final int i = 5;
final int j = i + 3;

</pre>
<p>Since every variable in FP is final two fairly interesting statements can be made. It does not make sense to always
write the keyword <em>final</em> and it does not make sense to call variables, well... variables. We will now make
two modifications to Java: every variable declared in our functional Java will be final by default, and we will
refer to variables as <em>symbols.</em></p>
<p>By now you are probably wondering how you could possibly write anything reasonably complicated in our newly created
language. If every symbol is non-mutable we cannot change the state of anything! This isn't strictly true. When Alonzo
was working on lambda calculus he wasn't interested in maintaining state over periods of time in order to modify it
later. He was interested in performing operations on data (also commonly referred to as "calculating stuff"). However,
it was proved that lambda calculus is equivalent to a Turing machine. It can do all the same things an imperative
programming language can. How, then, can we achieve the same results?</p>
<p>It turns out that functional programs can keep state, except they don't use variables to do it. They use functions
instead. The state is kept in function parameters, on the stack. If you want to keep state for a while and every now
and then modify it, you write a recursive function. As an example, let's write a function that reverses a Java string.
Remember, every variable we declare is final by default<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#strings-final">5</a></sup>.</p>
<pre>String reverse(String arg) {
    if(arg.length == 0) {
        return arg;
    }
    else {
        return reverse(arg.substring(1, arg.length)) + arg.substring(0, 1);
    }
}

</pre>
<p>This function is slow because it repeatedly calls itself<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#tail-calls">6</a></sup>. It's a memory hog because it repeatedly allocates objects.
But it's functional in style. You may be interested why someone would want to program in this manner. Well, I was just about
to tell you.</p>
<h2 id="sr-toc-4"><a>Benefits of FP</a></h2>
<p>You're probably thinking that there's no way I can rationalize the monstrosity of a function above.
When I was learning functional programming I was thinking that too. I was wrong. There are very good arguments for
using this style. Some of them are subjective. For example, people claim that functional programs are easier to
understand. I will leave out these arguments because every kid on the block knows that ease of understanding is in
the eye of the beholder. Fortunately for me, there are plenty of objective arguments.</p>
<h3 id="sr-toc-5">Unit Testing</h3>
<p>Since every symbol in FP is final, no function can ever cause side effects. You can never modify
things in place, nor can one function modify a value outside of its scope for another function to use (like a class member
or a global variable). That means that the only effect of evaluating a function is its return value and the only thing
that affects the return value of a function is its arguments.</p>
<p>This is a unit tester's wet dream. You can test every function in your program only worrying about its arguments.
You don't have to worry about calling functions in the right order, or setting up external state properly. All you need
to do is pass arguments that represent edge cases. If every function in your program passes unit tests you can be
a lot more confident about quality of your software than if you were using an imperative language. In Java or C++
checking a return value of a function is not sufficient - it may modify external state that we would need to verify. Not
so in a functional language.</p>

<h3 id="sr-toc-6">Debugging</h3>
<p>If a functional program doesn't behave the way you expect it to, debugging it is a breeze. You will
always be able to reproduce your problem because a bug in a functional program doesn't depend on unrelated code paths that
were executed before it. In an imperative program a bug resurfaces only some of the time. Because functions depend on external
state produced by side effects from other functions you may have to go through a series of steps in no way related to the
bug. In a functional program this isn't the case - if a return value of a function is wrong, it is <em>always</em> wrong,
regardless of what code you execute before running the function.</p>
<p>Once you reproduce the problem, getting to the bottom of it is trivial. It is almost pleasant. You break the execution
of your program and examine the stack. Every argument in every function call in the stack is available for your
inspection, just like in an imperative program. Except in an imperative program that's not enough because functions
depend on member variables, global variables, and the state of other classes (which in turn depend on these very same things). A
function in a functional program depends <em>only</em> on its arguments, and that information is right before your eyes! Furthermore,
in an imperative program examining a return value of a function will not give you a good idea of whether the function
behaves properly. You need to hunt down dozens of objects outside its scope to verify that it performed correct actions. In
a functional program all you have to do is look at the return value!</p>
<p>Walking through the stack you look at arguments passed to functions and their return values. The minute a return value
doesn't make sense you step into the offending function and walk through it. You repeat this recursively until the process
leads you to the source of the bug!</p>

<h3 id="sr-toc-7">Concurrency</h3>
<p>A functional program is ready for concurrency without any further modifications. You never have to worry about
deadlocks and race conditions because you don't need to use locks! No piece of data in a functional program is modified twice
by the same thread, let alone by two different threads. That means you can easily add threads without ever giving
conventional problems that plague concurrency applications a second thought!</p>
<p>If this is the case, why doesn't anybody use functional programs for highly concurrent applications? Well, it turns out
that they do. Ericsson designed a functional language called <a href="http://www.erlang.org/">Erlang</a> for use in its highly tolerant
and scalable telecommunication switches. Many others recognized the benefits provided by Erlang and started <a href="http://www.erlang.org/faq/faq.html#AEN50">using
it</a>. We're talking about telecommunication and traffic control systems that are far more scalable and reliable than
typical systems designed on Wall Street. Actually, Erlang systems are not scalable and reliable. Java systems are. Erlang
systems are simply rock solid.</p>
<p>The concurrency story doesn't stop here. If your application is inherently single threaded the compiler can still optimize
functional programs to run on multiple CPUs. Take a look at the following code fragment:</p>
<pre>String s1 = somewhatLongOperation1();
String s2 = somewhatLongOperation2();
String s3 = concatenate(s1, s2);

</pre>
<p>In a functional language the compiler could analyze the code, classify the functions that create strings <em>s1</em> and
<em>s2</em> as potentially time consuming operations, and run them concurrently. This is
impossible to do in an imperative language because each function may modify state outside of its scope and the function
following it may depend on it. In functional languages automatic analysis of functions and finding good candidates for
concurrent execution is as trivial as automatic inlining! In this sense functional style programs are "future proof" (as
much as I hate buzzwords, I'll indulge this time). Hardware manufacturers can no longer make CPUs run any faster. Instead
they increase the number of cores and attribute quadruple speed increases to concurrency. Of course they conveniently
forget to mention that we get our money's worth only on software that deals with parallelizable problems. This is a very small
fraction of imperative software but 100% of functional software because functional programs are all parallelizable out
of the box.</p>
<h3 id="sr-toc-8">Hot Code Deployment</h3>
<p>In the old days of Windows in order to install updates it was necessary to restart the computer. Many times.
After installing a newer version of a media players. With Windows XP the situation has improved significantly, yet it still
isn't ideal (I ran Windows Update at work today and now an annoying system tray icon won't go away until I restart). Unix
systems have had a better model for a while. In order to install an update you only need to stop relevant components, not the
whole OS. While it is a better situation, for a large class of server applications it still isn't acceptable. Telecommunication
systems need to be up 100% of the time because if dialing emergency is not available due to upgrades, lives may be lost. There is
no reason Wall Street firms need to bring down their systems to install software updates over the weekend.</p>
<p>An ideal situation is updating relevant parts of the code without stopping any part of the system at all. In an imperative
world this isn't possible. Consider unloading a Java class at runtime and reloading a new definition. If we were to do
that every instance of a class would become unusable because the state it holds would be lost. We would need to resort to
writing tricky version control code. We'd need to serialize all running instances of the class, destroy them, create
instances of the new class, try to load serialized data into them hoping the loading code properly migrates the data to work
with the new instance. On top of that, every time we change something we'd have to write our migration code manually.
And our migration code would have to take special care not to break relationships between objects.
Nice in theory, but would never work well in practice.</p>
<p>In a functional program all state is stored on the stack in the arguments passed to functions. This makes hot deployment
significantly easier! In fact, all we'd really have to do is run a diff between the code in production and the new version,
and deploy the new code. The rest could be done by language tools automatically! If you think this is science fiction, think
again. Erlang engineers have been <a href="http://www.erlang.org/doc/reference_manual/code_loading.html#12.3">upgrading</a>
live systems without stopping them for years.</p>

<h3 id="sr-toc-9">Machine Assisted Proofs and Optimizations</h3>
<p>An interesting property of functional languages is that they can be reasoned about mathematically. Since
a functional language is simply an implementation of a formal system, all mathematical operations that could be done on
paper still apply to the programs written in that language. The compiler could, for example, convert pieces of code into
equivalent but more efficient pieces with a mathematical proof that two pieces of code are equivalent<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#proof">7</a></sup>.
Relational databases have been performing these optimizations for years. There is no reason the same techniques can't apply
to regular software.</p>
<p>Additionally, you can use these techniques to prove that parts of your program are correct. It is even possible to create tools
that analyze code and generate edge cases for unit tests automatically! This functionality is invaluable for rock solid systems.
If you are designing pace makers and air traffic control systems such tools are almost always a requirement. If you are writing
an application outside of truly mission critical industries, these tools can give you a tremendous edge over your competitors.</p>

<h2 id="sr-toc-10"><a>Higher Order Functions</a></h2>
<p>I remember learning about the benefits I outlined above and thinking "that's all very nice but it's useless
if I have to program in a crippled language where everything is final." This was a misconception. Making all variables final
<em>is</em> crippled in a context of an imperative language like Java but it isn't in a context of functional languages. Functional
languages offer a different kind of abstraction tools that make you forget you've ever <em>liked</em> modifying variables. One
such tool is capability to work with <em>higher order functions.</em></p>
<p>A function in such languages is different from a function in Java or C. It is a superset - it can do all the things a Java
function can do, and more. We create a function in the same manner we do in C:</p>
<pre>int add(int i, int j) {
    return i + j;
}

</pre>
<p>This means something different from equivalent C code. Let's extend our Java compiler to support this notation. When we
type something like this our compiler will convert it to the following Java code (don't forget, everything is final):</p>
<pre>class add_function_t {
    int add(int i, int j) {
        return i + j;
    }
}

add_function_t add = new add_function_t();

</pre>
<p>The symbol <em>add</em> isn't really a function. It is a small class with one function as its member. We can now pass
<em>add</em> around in our code as an argument to other functions. We can assign it to another symbol. We can create instances
of <em>add_function_t</em> at runtime and they will be garbage collected when we no longer need them. This makes functions
<em>first class objects</em> no different from integers or strings. Functions that operate on other functions (accept them
as arguments) are called <em>higher order functions.</em> Don't let this term intimidate you, it's no different from Java
classes that operate on each other (we can pass class instances to other classes). We can call them "higher order classes" but nobody
cares to because there is no strong academic community behind Java.</p>
<p>How, and when, do you use higher order functions? Well, I'm glad you asked. You write your program as a big monolithic
blob of code without worrying about class hierarchies. When you see that a particular piece of code is repeated, you break it
out into a function (fortunately they still teach this in schools). If you see that a piece of logic within your function needs
to behave differently in different situations, you break it out into a higher order function. Confused? Here's a real life
example from my work.</p>
<p>Suppose we have a piece of Java code that receives a message, transforms it in various ways, and forwards it to another
server.</p>
<pre>class MessageHandler {
    void handleMessage(Message msg) {
        // ...
        msg.setClientCode("ABCD_123");
        // ...
        
        sendMessage(msg);
    }
    
    // ...
}

</pre>
<p>Now imagine that our system has changed and we now route messages to two servers instead of one. Everything is handled
in exactly the same way except the client code - the second server wants it in a different format. How do we handle this
situation? We could check where the message is headed and format the client code differently, like this:</p>
<pre>class MessageHandler {
    void handleMessage(Message msg) {
        // ...
        if(msg.getDestination().equals("server1") {
            msg.setClientCode("ABCD_123");
        } else {
            msg.setClientCode("123_ABC");
        }
        // ...
        
        sendMessage(msg);
    }
    
    // ...
}

</pre>
<p>This approach, however, isn't scalable. If more servers are added our function will grow linearly and we'll have a nightmare
updating it. An object oriented approach is to make <em>MessageHandler</em> a base class and specialize the client code
operation in derived classes:</p>
<pre>abstract class MessageHandler {
    void handleMessage(Message msg) {
        // ...
        msg.setClientCode(getClientCode());
        // ...
        
        sendMessage(msg);
    }
    
    abstract String getClientCode();
    
    // ...
}

class MessageHandlerOne extends MessageHandler {
    String getClientCode() {
        return "ABCD_123";
    }
}

class MessageHandlerTwo extends MessageHandler {
    String getClientCode() {
        return "123_ABCD";
    }
}

</pre>
<p>We can now instantiate an appropriate class for each server. Adding servers becomes much more maintainable. That's a lot of
code for such a simple modification though. We have to create two new types just to support different client codes! Now let's do
the same thing in our language that supports higher order functions:</p>
<pre>class MessageHandler {
    void handleMessage(Message msg, Function getClientCode) {
        // ...
        Message msg1 = msg.setClientCode(getClientCode());
        // ...
        
        sendMessage(msg1);
    }
    
    // ...
}

String getClientCodeOne() {
    return "ABCD_123";
}

String getClientCodeTwo() {
    return "123_ABCD";
}

MessageHandler handler = new MessageHandler();
handler.handleMessage(someMsg, getClientCodeOne);

</pre>
<p>We've created no new types and no class hierarchy. We simply pass appropriate functions as a parameter. We've achieved the same
thing as the object oriented counterpart with a number of advantages. We don't restrict ourselves to class hierarchies: we can pass
new functions at runtime and change them at any time with a much higher degree of granularity with less code. Effectively the compiler
has written object oriented "glue" code for us! In addition we get all the other benefits of FP. Of course the abstractions provided
by functional languages don't stop here. Higher order functions are just the beginning.</p>
<h2 id="sr-toc-11"><a>Currying</a></h2>
<p>Most people I've met have read the <a href="http://www.amazon.com/gp/product/0201633612/103-9055240-2348603">
Design Patterns</a> book by the Gang of Four. Any self respecting programmer will tell you that the book is language agnostic
and the patterns apply to software engineering in general, regardless of which language you use. This is a noble claim. Unfortunately
it is far removed from the truth.</p>
<p>Functional languages are extremely expressive. In a functional language one does not need design patterns because the language
is likely so high level, you end up programming in concepts that eliminate design patterns all together. Once such pattern is an 
Adapter pattern (how is it different from Facade again? Sounds like somebody needed to fill more pages to satisfy their contract).
It is eliminated once a language supports a technique called <em>currying</em>.</p>
<p>Adapter pattern is best known when applied to the "default" abstraction unit in Java - a class. In functional languages the
pattern is applied to functions. The pattern takes an interface and transforms it to another interface someone else expects.
Here's an example of an adapter pattern:</p>
<pre>int pow(int i, int j);
int square(int i)
{
    return pow(i, 2);
}

</pre>
<p>The code above adapts an interface of a function that raises an integer to an integer power to an interface of a function
that squares an integer. In academic circles this trivial technique is called currying (after a logician Haskell Curry who
performed mathematical acrobatics necessary to formalize it). Because in FP functions (as opposed to classes) are passed around
as arguments, currying is used very often to adapt functions to an interface that someone else expects. Since the interface to
functions is its arguments, currying is used to reduce the number of arguments (like in the example above).</p>
<p>Functional languages come with this technique built in. You don't need to manually create a function that wraps the original,
functional languages will do that for you. As usual, let's extend our language to support this technique.</p>
<pre>square = int pow(int i, 2);

</pre>
<div><div><pre>            &lt;p&gt;This will automatically create a function &lt;em&gt;square&lt;/em&gt; for us with one argument. It will call &lt;em&gt;pow&lt;/em&gt; function with
            the second argument set to &lt;em&gt;2&lt;/em&gt;. This will get compiled to the following Java code:&lt;/p&gt;

</pre></div></div>
<pre>class square_function_t {
    int square(int i) {
        return pow(i, 2);
    }
}
square_function_t square = new square_function_t();

</pre>
<p>As you can see, we've simply created a wrapper for the original function. In FP currying is just that - a shortcut to quickly
and easily create wrappers. You concentrate on your task, and the compiler writes the appropriate code for you! When do you use
currying? This should be easy. Any time you'd like to use an adapter pattern (a wrapper).</p>

<h2 id="sr-toc-12"><a>Lazy Evaluation</a></h2>
<p>Lazy (or delayed) evaluation is an interesting technique that becomes possible once we adopt a functional
philosophy. We've already seen the following piece of code when we were talking about concurrency:</p>
<pre>String s1 = somewhatLongOperation1();
String s2 = somewhatLongOperation2();
String s3 = concatenate(s1, s2);

</pre>
<p>In an imperative language the order of evaluation would be clear. Because each function may affect or depend on an external state
it would be necessary to execute them in order: first <em>somewhatLongOperation1</em>, then <em>somewhatLongOperation2</em>, followed
by <em>concatenate</em>. Not so in functional languages.</p>
<p>As we saw earlier <em>somewhatLongOperation1</em> and <em>somewhatLongOperation2</em> can be executed concurrently because we're
guaranteed no function affects or depends on global state. But what if we don't want to run the two concurrently, do we need to run
them in order? The answer is no. We only need to run these operations when another function depends on <em>s1</em> and <em>s2</em>.
We don't even have to run them before <em>concatenate</em> is called - we can delay their evaluation until they're required within
<em>concatenate</em>. If we replace <em>concatenate</em> with a function that has a conditional and uses only one of its two parameters
we may never evaluate one of the parameters at all! <a href="http://www.haskell.org/"><em>Haskell</em></a> is an example of a delayed
evaluation language. In <em>Haskell</em> you are not guaranteed that anything will be executed in order (or at all) because <em>Haskell</em>
only executes code when it's required.</p>
<p>Lazy evaluation has numerous advantages as well as disadvantages. We will discuss the advantages here and will explain how to counter
the disadvantages in the next section.</p>
<h3 id="sr-toc-13">Optimization</h3>
<p>Lazy evaluation provides a tremendous potential for optimizations. A lazy compiler thinks of functional code exactly as mathematicians
think of an algebra expression - it can cancel things out and completely prevent execution, rearrange pieces of code for higher efficiency,
even arrange code in a way that reduces errors, all guaranteeing optimizations won't break the code. This is the biggest benefit of
representing programs strictly using formal primitives - code adheres to mathematical laws and can be reasoned about mathematically.</p>
<h3 id="sr-toc-14">Abstracting Control Structures</h3>
<p>Lazy evaluation provides a higher order of abstraction that allows implementing things in a way that would otherwise
be impossible. For example consider implementing the following control structure:</p>
<pre>unless(stock.isEuropean()) {
    sendToSEC(stock);
}

</pre>
<p>We want <em>sendToSEC</em> executed unless the stock is European. How can we implement <em>unless</em>? Without lazy evaluation
we'd need some form of a macro system, but in a language like Haskell that's unnecessary. We can implement <em>unless</em> as a function!</p>
<pre>void unless(boolean condition, List code) {
    if(!condition)
        code;
}

</pre>
<p>Note that <em>code</em> is never evaluated if the condition is true. We cannot reproduce this behavior in a strict language because
the arguments would be evaluated before <em>unless</em> is entered.</p>
<h3 id="sr-toc-15">Infinite Data Structures</h3>
<p>Lazy languages allow for definition of infinite data structures, something that's much more complicated in a strict
language. For example, consider a list with Fibonacci numbers. We clearly can't compute and infinite list in a reasonable amount of
time or store it in memory. In strict languages like Java we simply define a Fibonacci function that returns a particular member
from the sequence. In a language like Haskell we can abstract it further and simply define an infinite list of Fibonacci numbers.
Because the language is lazy, only the necessary parts of the list that are actually used by the program are ever evaluated. This
allows for abstracting a lot of problems and looking at them from a higher level (for example, we can use list processing functions
on an infinite list).</p>
<h3 id="sr-toc-16">Disadvantages</h3>
<p>Of course there ain't no such thing as a free lunch(tm). Lazy evaluation comes with a number of disadvantages. Mainly that
it is, well, lazy. Many real world problems require strict evaluation. For example consider the following:</p>
<pre>System.out.println("Please enter your name: ");
System.in.readLine();

</pre>
<p>In a lazy language you have no guarantee that the first line will be executed before the second! This means we can't do IO, can't
use native functions in any meaningful way (because they need to be called in order since they depend on side effects), and can't
interact with the outside world! If we were to introduce
primitives that allow ordered code execution we'd lose the benefits of reasoning about our code mathematically (which would take
all of the benefits of functional programming with it). Fortunately not all is lost. Mathematicians got to work and developed a number
of tricks to ensure code gets executed in particular order in a functional setting. We get the best of both worlds! These techniques
include continuations, monads, and uniqueness typing. In this article we'll only deal with continuations. We'll leave monads and
uniqueness typing for another time. Interestingly, continuations are useful for many things other than enforcing a particular order
of evaluation. We'll talk about that as well.</p>

<h2 id="sr-toc-17"><a>Continuations</a></h2>
<p>Continuations to programming are what Da Vinci Code is to human history: an amazing revelation of the greatest
cover-up known to man. Well, may be not, but they're certainly revealing of deceit in the same sense as square roots of negative
numbers.</p>
<p>When we learned about functions we only learned half truths based on a faulty assumption that functions must return their
value to the original caller. In this sense continuations are a generalization of functions. A function must not necessarily return to
its caller and may return to any part of the program. A "continuation" is a parameter we may choose to pass to our function that
specifies where the function should return. The description may be more complicated than it sounds. Take a look at the following
code:</p>
<pre>int i = add(5, 10);
int j = square(i);

</pre>
<p>The function <em>add</em> returns <em>15</em> to be assigned to <em>i</em>, the place where <em>add</em> was originally called.
After that the value of <em>i</em> is used to call <em>square</em>. Note that a lazy compiler can't rearrange these lines of
code because the second line depends on successful evaluation of the first. We can rewrite this code block using <em>Continuation
Passing Style</em> or <em>CPS</em>, where the function <em>add</em> doesn't return to the original caller but instead returns its result to
<em>square</em>.</p>
<pre>int j = add(5, 10, square);

</pre>
<p>In this case <em>add</em> gets another parameter - a function that <em>add</em> must call with its result upon completion.
In this case <em>square</em> is a continuation of <em>add</em>. In both cases <em>j</em> will equal <em>225</em>.</p>
<p>Here lays the first trick to force a lazy language to evaluate two expressions in order. Consider the following (familiar) IO code:</p>
<pre>System.out.println("Please enter your name: ");
System.in.readLine();

</pre>
<p>The two lines don't depend on each other and the compiler is free to rearrange them as it wishes. However, if we rewrite this
code in CPS, there will be a dependency and the compiler will be forced to evaluate the two lines in order!</p>
<pre>System.out.println("Please enter your name: ", System.in.readLine);

</pre>
<p>In this case <em>println</em> needs to call <em>readLine</em> with its result and return the result of <em>readLine</em>. This
allows us to ensure that the two lines are executed in order <em>and</em> that <em>readLine</em> is evaluated at all (because the
whole computation expects the last value as a result). In case of Java <em>println</em> returns <em>void</em>
but if it were to return an abstract value (that <em>readLine</em> would accept), we'd solve our problem! Of course chaining
function calls like that will quickly become unreadable, but it isn't necessary. We could add syntactic sugar to the language that
will allow us to simply type expressions in order, and the compiler would chain the calls for us automatically. We can now
evaluate expressions in any order we wish without losing any of the benefits of FP (including the ability to reason about our
programs mathematically)! If this is still confusing, remember that a function is just an instance of a class with one member.
Rewrite above two lines so that <em>println</em> and <em>readLine</em> are instances of classes and everything will become clear.</p>
<p>I would now wrap up this section, except that we've only scratched the surface of continuations and their usefulness. We can write
entire programs in CPS, where every function takes an extra continuation argument and passes the result to it. We can also convert
any program to CPS simply by treating functions as special cases of continuations (functions that always return to their caller). This
conversion is trivial to do automatically (in fact, many compilers do just that).</p>
<p>Once we convert a program to CPS it becomes clear that every instruction has some continuation, a function it will call with the result,
which in a regular program would be a place it must return to. Let's
pick any instruction from above code, say <em>add(5, 10)</em>. In a program written in CPS style it's clear what <em>add</em>'s
continuation is - it's a function that <em>add</em> calls once it's done. But what is it in a non-CPS program? We could, of course, convert
the program to CPS, but do we have to?</p>
<p>It turns out that we don't. Look carefully at our CPS conversion. If you try to write a compiler for it and think about it long
enough you'll realize that the CPS version needs no stack! No function ever"returns" in the traditional sense, it just calls another
function with the result instead. We don't need to push function arguments on the stack with every call and then pop them back, we can
simply store them in some block of memory and use a jump instruction instead. We'll never need the original arguments - they'll never
be used again since no function ever returns!</p>
<p>So, programs written in CPS style have no stack but have an extra argument with a function to call. Programs not written in CPS
style have no argument with a function to call, but have the stack instead. What does the stack contain? Simply the arguments, and a
pointer to memory where the function should return. Do you see a light bulb? The stack simply contains continuation information! The
pointer to the return instruction in the stack is essentially the same thing as the function to call in CPS programs! If you wanted to find out what
continuation for <em>add(5, 10)</em> is, you'd simply have to examine the stack at the point of its execution!</p>
<p>So that was easy. A continuation and a pointer to the return instruction in the stack are really the same thing, only a continuation
is passed explicitly, so that it doesn't need to be the same place where the function was called from. If you remember that a continuation
is a function, and a function in our language is compiled to an instance of a class, you'll realize that a pointer to the return
instruction in the stack and the continuation argument are <em>really</em> the same thing, since our function (just like an instance
of a class) is simply a pointer. This means that at any given point in time in your program you can ask for a <em>current continuation</em>
(which is simply the information on the stack).</p>
<p>Ok, so we know what a current continuation is. What does it mean? When we get a current continuation and store it somewhere, we end up
storing the current state of our program - freezing it in time. This is similar to an OS putting itself into hibernation. A continuation
object contains the information necessary to restart the program from the point where the continuation object was acquired. An operating
system does this to your program all the time when it context switches between the threads. The only difference is that it keeps all
the control. If you ask for a continuation object (in Scheme this is done by calling <em>call-with-current-continuation</em> function)
you'll get an object that contains the current continuation - the stack (or in a CPS case the function to call next). You can store this
object in a variable (or alternatively, on disk). When you choose to "restart" your program with this continuation object you will
"transform" to the state of the program when you grabbed the continuation object. It's the same thing as switching back to a suspended
thread or waking up an OS from hibernation, except you can do it again and again. When an OS wakes up, the hibernation information is
destroyed. If it wasn't, you'd be able to wake up from the same point over and over again, almost like going back in time. You have
that control with continuations!</p>
<p>In what situations are continuations useful? Usually when you're trying to simulate state in an application of inherently stateless
nature to ease your life. A great application of continuations are <a href="http://www.seaside.st/">web applications</a>. Microsoft's
ASP.NET goes to tremendous lengths to try and simulate state so that you can write your application with less hassle. If C#
supported continuations half of ASP.NET's complexity would disappear - you'd simply store a continuation and restart it when a user
makes the web request again. To a programmer of the web application there would be no interruption - the program would simply start
from the next line! Continuations are an incredibly useful abstraction for some problems. Considering that many of the traditional
fat clients are moving to the web, continuations will become more and more important in the future.</p>

<div><div><pre>	&lt;h2&gt;&lt;a&gt;Pattern Matching&lt;/a&gt;&lt;/h2&gt;

</pre></div></div>
<p>Pattern matching is not a new or innovative feature. In fact, it has little to do with functional programming. The only
reason why it's usually attributed to FP is that functional languages have had pattern matching for some time, while modern imperative
languages still don't.</p>
<p>Let's dive into pattern matching with an example. Here's a Fibonacci function in Java:</p>
<pre>int fib(int n) {
    if(n == 0) return 1;
    if(n == 1) return 1;
        
    return fib(n - 2) + fib(n - 1);
}

</pre>
<p>And here's an example of a Fibonacci function in our Java-derived language that supports pattern matching:</p>
<pre>int fib(0) {
    return 1;
}
int fib(1) {
    return 1;
}
int fib(int n) {
    return fib(n - 2) + fib(n - 1);
}

</pre>
<p>What's the difference? The compiler implements branching for us.</p>
<p>What's the big deal? There isn't any. Someone noticed that a large number of functions contain very complicated switch statements
(this is particularly true about functional programs) and decided that it's a good idea to abstract that away. We split the function
definition into multiple ones, and put patterns in place of some arguments (sort of like overloading). When the function is called, the
compiler compares the arguments with the definitions at runtime, and picks the correct one. This is usually done by picking the most
specific definition available. For example, <em>int fib(int n)</em> can be called with <em>n</em> equal to <em>1</em>, but it isn't
because <em>int fib(1)</em> is more specific.</p>
<p>Pattern matching is usually more complex than our example reveals. For example, an advanced pattern matching system will allow us to
do the following:</p>
<pre>int f(int n &lt; 10) { ... }
int f(int n) { ... }

</pre>
<p>When is pattern matching useful? In a surprisingly large number of cases! Every time you have a complex structure of nested <em>if</em>s,
pattern matching can do a better job with less code on your part. A good function that comes to mind is a standard <em>WndProc</em>
function that all Win32 applications must provide (even though it's often abstracted away). Usually a pattern matching system can
examine collections as well as simple values. For example, if you pass an array to your function you could pick out all arrays in which
the first element is equal to <em>1</em> and the third element is greater than <em>3</em>.</p>
<p>Another benefit of pattern matching is that if you need to add or modify conditions, you don't have to go into one huge function.
You simply add (or modify) appropriate definitions. This eliminates the need for a whole range of design patterns from the GoF book.
The more complex your conditions are, the more pattern matching will help you. Once you're used to it, you
start wondering how you ever got through your day without it.</p>
<h2 id="sr-toc-18"><a>Closures</a></h2>
<p>So far we've discussed features in the context of"pure" functional languages -
languages that are implementations of lambda calculus and don't include features
that conflict with Church's formalism. However, many of the features of functional
languages are useful outside of lambda calculus framework. While an implementation
of an axiomatic system is useful because it allows thinking about programs in terms
of mathematical expressions, it may or may not always be practical. Many languages
choose to incorporate functional elements without strictly adhering to functional
doctrine. Many such languages (like Common Lisp) don't require variables to be final
- you can modify things in place. They also don't require functions to depend only
on their arguments - functions are allowed to access state outside of their boundaries.
But they do include functional features - like higher order functions. Passing functions
around in impure languages is a little bit different than doing it in the confines
of lambda calculus and requires support for an interesting feature often referred
to as lexical closure. Let's take a look at some sample code. Remember, in this
case variables aren't final and functions can refer to variables outside of their
scope:</p>
<pre>Function makePowerFn(int power) {
   int powerFn(int base) {
       return pow(base, power);
   }

   return powerFn;
}

Function square = makePowerFn(2);
square(3); // returns 9

</pre>
<p>The function <em>make-power-fn</em> returns a function that takes a single
argument and raises it to a certain power. What happens when we try to
evaluate <em>square(3)</em>? The variable <em>power</em> isn't anywhere in scope of
<em>powerFn</em> because <em>makePowerFn</em> has returned and its stack is long gone.
How can <em>square</em> work, then? The language must, somehow, store the value
of <em>power</em> somewhere for <em>square</em> to work. What if we create another
function, <em>cube</em>, that raises something to the third power? The runtime
must now store two copies of power, one for each function we generated
using <em>make-power-fn</em>. The phenomenon of storing these values is called a
<em>closure</em>. Closures don't only store arguments of a host function. For
example, a closure can look like this:</p>
<pre>Function makeIncrementer() {
   int n = 0;

   int increment() {
       return ++n;
   }
}

Function inc1 = makeIncrementer();
Function inc2 = makeIncrementer();

inc1(); // returns 1;
inc1(); // returns 2;
inc1(); // returns 3;
inc2(); // returns 1;
inc2(); // returns 2;
inc2(); // returns 3;

</pre>
<p>The runtime manages to store <em>n</em>, so incrementers can access it.
Furthermore, it stores various copies, one for each incrementer, even
though they're supposed to disappear when <em>makeIncrementer</em> returns.
What does this code compile to? How do closures work behind the
scenes? Fortunately, we have a back stage pass.</p>
<p>A little common sense goes a long way. The first observation is that
local variables are no longer limited to simple scope rules and have
an undefined lifetime. The obvious conclusion is that they're no
longer stored on the stack - they must be stored on the heap instead<sup><a href="file:///C:/N-20L6PF1RKJ6B-Data/maoy/Downloads/simpread-Functional%20Programming%20For%20The%20Rest%20of%20Us%20%20defmacro.html#gc-alloc-speed">8</a></sup>.
A closure, then, is implemented just like a function we discussed
earlier, except that it has an additional reference to the surrounding
variables:</p>
<pre>class some_function_t {
   SymbolTable parentScope;
   
   // ...
}

</pre>
<p>When a closure references a variable that's not in its local scope, it
consults this reference for a parent scope. That's it! Closures bring functional and
OO worlds closer together. Every time you create a class that holds some state and pass it to somewhere else, think
of closures. A closure is just an object
that creates "member variables" on the fly by grabbing them from the scope,
so you don't have to!</p>
<h2 id="sr-toc-19"><a>What's next?</a></h2>
<p>This article only scratches the surface of functional programming. Sometimes a small scratch
can progress to something bigger and in our case it's a good thing. In the future I plan to write about
category theory, monads, functional data structures, type systems in functional languages,
functional concurrency, functional databases and much more. If I get to write (and in the process learn) about
half of these topics my life will be complete. In the meantime, <a href="http://www.google.com/">Google</a>
is our friend.</p>

<h2 id="sr-toc-20"><a>Comments?</a></h2>
<p>If you have any questions, comments, or suggestions, please drop a note at <a href="mailto:coffeemug@gmail.com">coffeemug@gmail.com</a>.
  I'll be glad to hear your feedback.</p>

<hr class="simpread-hidden">



  </div>
</article>

      </div><p></p></sr-rd-content>
                            
                            <sr-rd-footer>
                                <sr-rd-footer-group>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                    <sr-rd-footer-text>全文完</sr-rd-footer-text>
                                    <sr-rd-footer-line></sr-rd-footer-line>
                                </sr-rd-footer-group>
                                <sr-rd-footer-copywrite>
                                    <div>本文由 <a href="http://ksria.com/simpread" target="_blank">简悦 SimpRead</a> 转码，用以提升阅读体验，<a href="https://www.defmacro.org/2006/06/19/fp.html" target="_blank">原文地址 </a></div>
                                </sr-rd-footer-copywrite>
                            </sr-rd-footer>
                        </sr-read>
                    
                </body></html>